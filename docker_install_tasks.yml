- name: Gather package facts
  package_facts:
    manager: auto

- name: Download Docker install script
  get_url:
    dest: /tmp/docker-install.sh
    force: yes
    mode: 700
    url: https://get.docker.com
  when: "'docker-ce' not in ansible_facts.packages"

- name: Install Docker
  shell:
    cmd: /tmp/docker-install.sh
    executable: /bin/sh
  when: "'docker-ce' not in ansible_facts.packages"
  